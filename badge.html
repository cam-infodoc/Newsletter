<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Mes Badges Info-Doc</title>
<style>
body {
    font-family: Arial, sans-serif;
}
.badges-wrapper {
    display: flex;
    align-items: flex-start;
    gap: 40px;
}
.badges-list .badge {
    width: 80px;
    height: 80px;
    border-radius: 12px;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 15px;
    opacity: 0.5;
    transition: all 0.3s ease;
}
.badges-list .badge.unlocked {
    opacity: 1;
    transform: scale(1.1);
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
}
#explorateur { background-color: #FFF9C4; }
#lecteur { background-color: #BBDEFB; }
#confiance { background-color: #FFE0B2; }
#premium { background-color: #E1BEE7; }

.badge-name { text-align: center; margin-top: 5px; font-weight: bold; }
.badge-reward-display { font-size: 16px; font-weight: bold; min-width: 200px; }
.icon { font-size: 40px; }
</style>
</head>
<body>

<h2>Mes Badges</h2>
<div class="badges-wrapper">
    <div class="badges-list">
        <div class="badge" id="explorateur"><span class="icon">‚≠ê</span><div class="badge-name">Explorateur</div></div>
        <div class="badge" id="lecteur"><span class="icon">üìò</span><div class="badge-name">Lecteur</div></div>
        <div class="badge" id="confiance"><span class="icon">üîí</span><div class="badge-name">Confiance</div></div>
        <div class="badge" id="premium"><span class="icon">üëë</span><div class="badge-name">Premium</div></div>
    </div>
    <div class="badge-reward-display" id="reward-display"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "TON_API_KEY",
  authDomain: "TON_AUTH_DOMAIN",
  projectId: "TON_PROJECT_ID",
  storageBucket: "TON_STORAGE_BUCKET",
  messagingSenderId: "TON_MSG_ID",
  appId: "TON_APP_ID"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// R√©cup√©rer uid depuis l'URL
const urlParams = new URLSearchParams(window.location.search);
const uid = urlParams.get('uid');
const badgeParam = urlParams.get('badge'); // facultatif

if(uid){
    const userRef = db.collection('users').doc(uid);

    // Mettre √† jour badge si badgeParam pr√©sent
    if(badgeParam){
        userRef.update({
            badges: firebase.firestore.FieldValue.arrayUnion(badgeParam),
            lastBadge: badgeParam
        });
    }

    // R√©cup√©rer badges
    userRef.get().then(doc => {
        if(doc.exists){
            const data = doc.data();
            const badges = data.badges || [];
            const lastBadge = data.lastBadge || null;

            // D√©bloquer badges visuellement
            badges.forEach(b => {
                const elem = document.getElementById(b);
                if(elem) elem.classList.add('unlocked');
            });

            // Afficher la r√©compense du dernier badge
            const rewardDisplay = document.getElementById('reward-display');
            if(lastBadge){
                let rewardText = '';
                switch(lastBadge){
                    case 'explorateur': rewardText = 'Mini-guide bonus PDF'; break;
                    case 'lecteur': rewardText = 'Code promo -5% sur un Guide PDF (INFO5)'; break;
                    case 'confiance': rewardText = 'Code promo -2‚Ç¨ sur un Guide PDF (ASTUCE2)'; break;
                    case 'premium': rewardText = 'PDF gratuit (INFOFREE)'; break;
                }
                rewardDisplay.textContent = rewardText;
            }
        }
    });
}
</script>

</body>
</html>
